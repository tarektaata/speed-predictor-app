# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1lsUUe7sn3zcmVCxYmF5_80MYW7P4jCo0
"""

# Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
import pandas as pd
import numpy as np

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ Ø¯Ø§Ø®Ù„ Google Colab
from google.colab import files
uploaded = files.upload()

# Ù‚Ø±Ø§Ø¡Ø© Ø£ÙˆÙ„ Ù…Ù„Ù ØªÙ… Ø±ÙØ¹Ù‡ Ø¨ØµÙŠØºØ© Excel
df = pd.read_excel(list(uploaded.keys())[0])

# Ù…Ø¹Ø§ÙŠÙ†Ø© Ø£ÙˆÙ„ 5 ØµÙÙˆÙ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
df.head()

# Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø¨Ø£Ø³Ù…Ø§Ø¡ Ù…Ù†Ø·Ù‚ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
df.columns = ['row_id', 'round_number', 'speed']

# Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„ Ù„Ùˆ Ù…Ø´ Ù…Ù‡Ù…
df.drop(columns=['row_id'], inplace=True)

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´ÙƒÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙ
df.head()

# ØªØ­ÙˆÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ù„Ø£Ø±Ù‚Ø§Ù… (Ù„Ùˆ ÙÙŠÙ‡Ø§ Ù‚ÙŠÙ… Ù†ØµÙŠØ© ØºÙ„Ø· ØªØªØ­ÙˆÙ„ NaN)
df = df.apply(pd.to_numeric, errors='coerce')

# Ø­Ø°Ù Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù„ÙŠ ÙÙŠÙ‡Ø§ Ù‚ÙŠÙ… Ù†Ø§Ù‚ØµØ©
df.dropna(inplace=True)

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙ
df.head()

# ÙØµÙ„ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
X = df[['round_number']]
y = df['speed']

# Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø´ÙƒÙ„
print("X shape:", X.shape)
print("y shape:", y.shape)

# Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
from sklearn.linear_model import LinearRegression
from sklearn.tree import DecisionTreeRegressor
from sklearn.ensemble import RandomForestRegressor

# ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
lr = LinearRegression().fit(X, y)
dt = DecisionTreeRegressor().fit(X, y)
rf = RandomForestRegressor().fit(X, y)

# Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯ (Ù…Ø«Ù„Ø§Ù‹ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø±Ù‚Ù… 501)
new_round = pd.DataFrame({'round_number': [501]})
print("ğŸ”¹ Linear Regression prediction:", lr.predict(new_round)[0])
print("ğŸ”¸ Decision Tree prediction:", dt.predict(new_round)[0])
print("ğŸ”¹ Random Forest prediction:", rf.predict(new_round)[0])

# !pip install streamlit â† Ù…Ø´ Ø¶Ø±ÙˆØ±ÙŠ Ø¯Ø§Ø®Ù„ Streamlit Cloud

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©
file_name = list(uploaded.keys())[0]  # â† Ø¨ÙŠØ¬ÙŠØ¨ Ø§Ø³Ù… Ø£ÙˆÙ„ Ù…Ù„Ù Ù…Ø±ÙÙˆØ¹ ÙØ¹Ù„ÙŠÙ‹Ø§
df = pd.read_excel(file_name)

df = pd.read_excel('1 Wen.xlsx')  # â† Ø§Ø³ØªØ®Ø¯Ù… Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ

from sklearn.metrics import mean_squared_error, r2_score

print("Linear R2:", r2_score(y, lr.predict(X)))
print("Decision Tree R2:", r2_score(y, dt.predict(X)))
print("Random Forest R2:", r2_score(y, rf.predict(X)))

import streamlit as st

st.title("ØªÙˆÙ‚Ø¹ Ø§Ù„Ø³Ø±Ø¹Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆÙ„Ø©")
round_input = st.number_input("Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆÙ„Ø©", min_value=1)
if st.button("ØªÙˆÙ‚Ù‘Ø¹"):
    new_round = pd.DataFrame({'round_number': [round_input]})
    prediction = rf.predict(new_round)[0]
    st.success(f"Ø§Ù„ØªÙˆÙ‚Ø¹: {prediction:.2f}")

new_round = pd.DataFrame({'round_number': [501]})
prediction = rf.predict(new_round)[0]  # â† Ø¯Ù‡ Ø§Ù„Ù„ÙŠ Ø¨ÙŠØ­Ø¯Ø¯ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©

results = []
# Ø¨Ø¹Ø¯ ÙƒÙ„ ØªÙˆÙ‚Ø¹ØŒ Ù†Ø¶ÙŠÙ Ù„Ù„Ù€ list
results.append({"round_number": 501, "predicted_speed": prediction})
df_results = pd.DataFrame(results)
df_results.to_excel("predictions.xlsx", index=False)

results = []

# ØªÙˆÙ‚Ø¹ Ø³Ø±Ø¹Ø© Ø§Ù„Ø¬ÙˆÙ„Ø© Ø±Ù‚Ù… 501
new_round = pd.DataFrame({'round_number': [501]})
prediction = rf.predict(new_round)[0]

# Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©
results.append({"round_number": 501, "predicted_speed": prediction})
df_results = pd.DataFrame(results)
df_results.to_excel("predictions.xlsx", index=False)

print("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙˆÙ‚Ø¹ ÙÙŠ Ù…Ù„Ù predictions.xlsx")

from google.colab import files
uploaded = files.upload()

list(uploaded.keys())  # â† Ø¨ÙŠØ·Ø¨Ø¹ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù„ÙŠ Ø±ÙØ¹ØªÙÙ‡

file_name = list(uploaded.keys())[0]
df = pd.read_excel(file_name)

import streamlit as st
import pandas as pd
from sklearn.ensemble import RandomForestRegressor
from google.colab import files

st.title("ğŸš€ ØªÙˆÙ‚Ø¹ Ø§Ù„Ø³Ø±Ø¹Ø© Ø­Ø³Ø¨ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆÙ„Ø©")

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
uploaded_file = st.file_uploader("ğŸ“‚ Ø§Ø±ÙØ¹ Ù…Ù„Ù Excel ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", type=["xlsx"])
if uploaded_file is not None:
    df = pd.read_excel(uploaded_file)

    # ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    df.columns = ['row_id', 'round_number', 'speed']
    df.drop(columns=['row_id'], inplace=True)
    df = df.apply(pd.to_numeric, errors='coerce')
    df.dropna(inplace=True)

    X = df[['round_number']]
    y = df['speed']

    # ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
    rf = RandomForestRegressor().fit(X, y)

    # ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªÙˆÙ‚Ø¹
    round_input = st.number_input("ğŸ¯ Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆÙ„Ø© Ù„Ù„ØªÙˆÙ‚Ø¹", min_value=1)
    if st.button("Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©"):
        new_round = pd.DataFrame({'round_number': [round_input]})
        prediction = rf.predict(new_round)[0]
        st.success(f"âœ… Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ù„Ù„Ø¬ÙˆÙ„Ø© {round_input}: {prediction:.2f}")

        # ØªØµØ¯ÙŠØ± Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù…Ù„Ù Excel
        result_df = pd.DataFrame([{"round_number": round_input, "predicted_speed": prediction}])
        result_df.to_excel("prediction_result.xlsx", index=False)
        st.info("ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙŠ prediction_result.xlsx")

import streamlit as st
import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.tree import DecisionTreeRegressor
from sklearn.ensemble import RandomForestRegressor

# Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
uploaded_file = st.file_uploader("Ø§Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„", type=["xlsx"])
if uploaded_file is not None:
    df = pd.read_excel(uploaded_file)

    df.columns = ['row_id', 'round_number', 'speed']
    df.drop(columns=['row_id'], inplace=True)

    df = df.apply(pd.to_numeric, errors='coerce')
    df.dropna(inplace=True)

    # Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 5 ØµÙÙˆÙ
    st.write("ğŸ“Š Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨:")
    st.write(df.head())

    # Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø®Ø±Ø¬Ø§Øª
    X = df[['round_number']]
    y = df['speed']

    # ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
    lr = LinearRegression().fit(X, y)
    dt = DecisionTreeRegressor().fit(X, y)
    rf = RandomForestRegressor().fit(X, y)

    # ØªÙˆÙ‚Ø¹ Ø§Ù„Ø³Ø±Ø¹Ø© Ø­Ø³Ø¨ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆÙ„Ø©
    round_num = st.number_input("Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆÙ„Ø© Ù„Ù„ØªÙˆÙ‚Ø¹", min_value=1)
    if round_num:
        input_df = pd.DataFrame({'round_number': [round_num]})
        st.write(f"ğŸ”¹ Linear Regression Prediction: {lr.predict(input_df)[0]:.2f}")
        st.write(f"ğŸ”¸ Decision Tree Prediction: {dt.predict(input_df)[0]:.2f}")
        st.write(f"ğŸ”¹ Random Forest Prediction: {rf.predict(input_df)[0]:.2f}")
